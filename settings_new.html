
<!DOCTYPE html>
<html lang="de">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Einstellungen</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" href="css/main.css?v=20260109">
	<link rel="stylesheet" href="css/settings_new.css">
</head>
<body>
	<!-- Navbar -->
	<nav class="navbar">
		<div class="navbar-content">
			<a href="index.html" class="navbar-brand">
				<i class="fas fa-map-location-dot"></i> AUT Quiz
			</a>
			<div class="navbar-menu">
				<button class="menu-toggle" id="menuToggle" aria-label="Menü" type="button">
					<i class="fas fa-bars"></i>
				</button>
				<div class="menu-dropdown" id="menuDropdown">
					<a href="points.html" class="menu-item">
						<i class="fas fa-coins"></i> <span>Punkte: <span id="menuPointsDisplay">0</span></span>
					</a>
					<a href="help.html" class="menu-item">
						<i class="fas fa-question-circle"></i> Hilfe
					</a>
					<a href="faq.html" class="menu-item">
						<i class="fas fa-circle-question"></i> FAQ
					</a>
					<a href="settings_new.html" class="menu-item">
						<i class="fas fa-cog"></i> Einstellungen
					</a>
				</div>
			</div>
		</div>
	</nav>

	<main class="container">
		<h1 class="settings-title"><i class="fas fa-cog"></i> Einstellungen</h1>
		<div class="settings-tabs">
			<button class="tab-btn active" data-tab="general">Allgemein</button>
			<button class="tab-btn" data-tab="appearance">Erscheinung</button>
			<button class="tab-btn" data-tab="game">Spieloptionen</button>
			<button class="tab-btn" data-tab="accessibility">Barrierefreiheit</button>
			<button class="tab-btn" data-tab="developer">Entwickler</button>
		</div>
		<div class="settings-content">
			<div class="tab-panel active" id="general">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-user"></i> Account</h2>
						<div class="account-info">
							<span><i class="fas fa-user-circle"></i> Gast</span>
							<span class="account-placeholder">(Login-Funktion in Entwicklung)</span>
						</div>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-language"></i> Sprache</h2>
						<label for="language-select">Sprache wählen:</label>
						<select id="language-select">
							<option value="de">Deutsch</option>
							<option value="en">English</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-volume-up"></i> Sound</h2>
						<label class="switch">
							<input type="checkbox" id="sound-toggle">
							<span class="slider round"></span>
						</label>
						<span id="sound-status">Sound ist aus</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-bell"></i> Benachrichtigungen</h2>
						<label class="switch">
							<input type="checkbox" id="notifications-toggle">
							<span class="slider round"></span>
						</label>
						<span id="notifications-status">Benachrichtigungen sind aus</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-history"></i> Fortschritt</h2>
						<button id="reset-progress-btn" class="reset-btn"><i class="fas fa-eraser"></i> Fortschritt zurücksetzen</button>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-undo"></i> Zurücksetzen</h2>
						<button id="reset-btn" class="reset-btn"><i class="fas fa-trash-restore"></i> Alle Einstellungen zurücksetzen</button>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="appearance">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-palette"></i> Design</h2>
						<label for="theme-select">Farbschema:</label>
						<select id="theme-select">
							<option value="light">Hell</option>
							<option value="dark">Dunkel</option>
							<option value="auto">Automatisch</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-font"></i> Schriftgröße</h2>
						<label for="font-size-select">Schriftgröße:</label>
						<select id="font-size-select">
							<option value="normal">Normal</option>
							<option value="large">Groß</option>
							<option value="xlarge">Sehr groß</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-magic"></i> Animationen</h2>
						<label class="switch">
							<input type="checkbox" id="animations-toggle">
							<span class="slider round"></span>
						</label>
						<span id="animations-status">Animationen sind an</span>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="game">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-clock"></i> Timer</h2>
						<label class="switch">
							<input type="checkbox" id="timer-enabled-toggle">
							<span class="slider round"></span>
						</label>
						<span id="timer-enabled-status">Timer ist aus</span>
						<div id="timer-duration-container" style="display: none; margin-top: 1rem;">
							<label for="timer-duration-select">Timer-Dauer (Sekunden):</label>
							<select id="timer-duration-select">
								<option value="15">15</option>
								<option value="30">30</option>
								<option value="45">45</option>
								<option value="60">60</option>
							</select>
						</div>
						<div id="timer-visual-container" style="display: none; margin-top: 1rem;">
							<label class="switch">
								<input type="checkbox" id="timer-visual-toggle">
								<span class="slider round"></span>
							</label>
							<span id="timer-visual-status">Visueller Timer ist an</span>
						</div>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-map-marker-alt"></i> Hauptstadt-Modus</h2>
						<label for="capital-mode-select">Standard-Modus:</label>
						<select id="capital-mode-select">
							<option value="all">Alle Hauptstädte</option>
							<option value="federal">Bundesländer-Hauptstädte</option>
							<option value="district">Bezirkshauptstädte</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-coins"></i> Punkte-Anzeige</h2>
						<label for="balance-display-select">Anzeige-Modus:</label>
						<select id="balance-display-select">
							<option value="widget">Widget</option>
							<option value="header">Im Header</option>
						</select>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="accessibility">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-eye"></i> High Contrast</h2>
						<label class="switch">
							<input type="checkbox" id="contrast-toggle">
							<span class="slider round"></span>
						</label>
						<span id="contrast-status">High Contrast ist aus</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-mouse-pointer"></i> Reduzierte Bewegungen</h2>
						<label class="switch">
							<input type="checkbox" id="reduced-motion-toggle">
							<span class="slider round"></span>
						</label>
						<span id="reduced-motion-status">Bewegungen sind normal</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-volume-off"></i> Screen Reader</h2>
						<label class="switch">
							<input type="checkbox" id="screen-reader-toggle">
							<span class="slider round"></span>
						</label>
						<span id="screen-reader-status">Screen Reader ist aus</span>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="developer">
				<div class="settings-card dev-tools-card">
					<section class="settings-section">
						<h2><i class="fas fa-tools"></i> Entwickler-Tools</h2>
						<button id="toggleDevMode" class="dev-btn"><i class="fas fa-terminal"></i> Dev Mode umschalten</button>
						<button id="showDevReloadBtn" class="dev-btn"><i class="fas fa-sync-alt"></i> Reload-Button anzeigen/verstecken</button>
						<button id="devHardReloadBtn" class="dev-btn"><i class="fas fa-broom"></i> Hard Reload & Cache leeren</button>
						<div id="devModeStatus"></div>
					</section>
				</div>
			</div>
		</div>
	</main>

	<!-- Footer Container - wird durch footer.js geladen -->
	<div id="footer-container"></div>

	<script src="components/footer.js"></script>
	<script src="script.js"></script>
	<script>
	// Settings-Initialisierung in EINEM DOMContentLoaded-Block
	document.addEventListener('DOMContentLoaded', function() {
	    // Mobiles Menü
	    const menuToggle = document.getElementById('menuToggle');
	    const menuDropdown = document.getElementById('menuDropdown');
	    if (menuToggle && menuDropdown) {
	        menuToggle.addEventListener('click', function(e) {
	            e.preventDefault();
	            e.stopPropagation();
	            menuToggle.classList.toggle('active');
	            menuDropdown.classList.toggle('show');
	        });
	        document.addEventListener('click', function(e) {
	            if (!menuToggle.contains(e.target) && !menuDropdown.contains(e.target)) {
	                menuToggle.classList.remove('active');
	                menuDropdown.classList.remove('show');
	            }
	        });
	    }

	    // Theme
	    const themeSelect = document.getElementById('theme-select');
	    function applyTheme(theme) {
	        if (theme === 'dark') {
	            document.body.classList.add('dark-mode');
	        } else {
	            document.body.classList.remove('dark-mode');
	        }
	        localStorage.setItem('theme', theme);
	    }
	    const savedTheme = localStorage.getItem('theme') || 'light';
	    themeSelect.value = savedTheme;
	    applyTheme(savedTheme);
	    themeSelect.addEventListener('change', (e) => {
	        applyTheme(e.target.value);
	    });

	    // Sprache
	    const languageSelect = document.getElementById('language-select');
	    function applyLanguage(lang) {
	        localStorage.setItem('language', lang);
	        // Platzhalter für spätere Übersetzungsfunktion
	    }
	    const savedLang = localStorage.getItem('language') || 'de';
	    languageSelect.value = savedLang;
	    languageSelect.addEventListener('change', (e) => {
	        applyLanguage(e.target.value);
	    });

	    // Schriftgröße
	    const fontSizeSelect = document.getElementById('font-size-select');
	    function applyFontSize(size) {
	        document.body.classList.remove('font-large', 'font-xlarge');
	        if (size === 'large') document.body.classList.add('font-large');
	        if (size === 'xlarge') document.body.classList.add('font-xlarge');
	        localStorage.setItem('fontSize', size);
	    }
	    const savedFont = localStorage.getItem('fontSize') || 'normal';
	    fontSizeSelect.value = savedFont;
	    applyFontSize(savedFont);
	    fontSizeSelect.addEventListener('change', (e) => {
	        applyFontSize(e.target.value);
	    });

	    // Sound
	    const soundToggle = document.getElementById('sound-toggle');
	    const soundStatus = document.getElementById('sound-status');
	    function updateSoundStatus() {
	        const enabled = soundToggle.checked;
	        soundStatus.textContent = enabled ? 'Sound ist an' : 'Sound ist aus';
	        localStorage.setItem('soundEnabled', enabled ? 'true' : 'false');
	    }
	    soundToggle.checked = localStorage.getItem('soundEnabled') === 'true';
	    updateSoundStatus();
	    soundToggle.addEventListener('change', updateSoundStatus);

	    // Benachrichtigungen
	    const notificationsToggle = document.getElementById('notifications-toggle');
	    const notificationsStatus = document.getElementById('notifications-status');
	    function updateNotificationStatus() {
	        const enabled = notificationsToggle.checked;
	        notificationsStatus.textContent = enabled ? 'Benachrichtigungen sind an' : 'Benachrichtigungen sind aus';
	        localStorage.setItem('notificationsEnabled', enabled ? 'true' : 'false');
	    }
	    notificationsToggle.checked = localStorage.getItem('notificationsEnabled') === 'true';
	    updateNotificationStatus();
	    notificationsToggle.addEventListener('change', updateNotificationStatus);

	    // Fortschritt zurücksetzen
	    const resetProgressBtn = document.getElementById('reset-progress-btn');
	    function resetProgress() {
	        localStorage.removeItem('pointsData');
	        localStorage.removeItem('foundEasterEggs');
	        alert('Fortschritt wurde zurückgesetzt!');
	    }
	    resetProgressBtn.addEventListener('click', resetProgress);

	    // Einstellungen zurücksetzen
	    const resetBtn = document.getElementById('reset-btn');
	    function resetSettings() {
	        localStorage.clear();
	        location.reload();
	    }
	    resetBtn.addEventListener('click', resetSettings);

	    // Entwickler-Tools
	    const devModeBtn = document.getElementById('toggleDevMode');
	    const showDevReloadBtn = document.getElementById('showDevReloadBtn');
	    const devModeStatus = document.getElementById('devModeStatus');
	    function updateDevModeStatus() {
	        const devMode = localStorage.getItem('devMode') === 'true';
	        const reloadBtn = localStorage.getItem('showDevReloadBtn') !== 'false';
	        devModeStatus.innerHTML = `<b>Dev Mode:</b> ${devMode ? 'Aktiviert' : 'Deaktiviert'}<br><b>Reload-Button:</b> ${reloadBtn ? 'Sichtbar' : 'Versteckt'}`;
	    }
	    devModeBtn.addEventListener('click', () => {
	        const current = localStorage.getItem('devMode') === 'true';
	        localStorage.setItem('devMode', (!current).toString());
	        updateDevModeStatus();
	    });
	    showDevReloadBtn.addEventListener('click', () => {
	        const current = localStorage.getItem('showDevReloadBtn') !== 'false';
	        localStorage.setItem('showDevReloadBtn', (!current).toString());
	        updateDevModeStatus();
	    });
	    updateDevModeStatus();

	    // Hard Reload & Cache leeren
	    const devHardReloadBtn = document.getElementById('devHardReloadBtn');
	    if (devHardReloadBtn) {
	        devHardReloadBtn.addEventListener('click', async (e) => {
	            e.preventDefault();
	            devHardReloadBtn.classList.add('spinning');
	            devHardReloadBtn.disabled = true;
	            try {
	                // Service Worker Cache leeren
	                if ('caches' in window) {
	                    const cacheNames = await caches.keys();
	                    await Promise.all(cacheNames.map(name => caches.delete(name)));
	                }
	                // Service Worker deregistrieren
	                if ('serviceWorker' in navigator) {
	                    const registrations = await navigator.serviceWorker.getRegistrations();
	                    await Promise.all(registrations.map(reg => reg.unregister()));
	                }
	                sessionStorage.setItem('cacheCleared', 'true');
	                setTimeout(() => { location.reload(true); }, 500);
	            } catch (error) {
	                console.error('Cache clear error:', error);
	                location.reload(true);
	            }
	        });
	        // Zeige Erfolgs-Toast wenn gerade Cache geleert wurde
	        if (sessionStorage.getItem('cacheCleared') === 'true') {
	            sessionStorage.removeItem('cacheCleared');
	            showCacheClearedToast();
	        }
	    }
	    // Toast-Notification für Cache Clear
	    function showCacheClearedToast() {
	        const toast = document.createElement('div');
	        toast.className = 'cache-cleared-toast';
	        toast.innerHTML = `<i class=\"fas fa-check-circle\"></i> <span>Cache geleert & neu geladen!</span>`;
	        document.body.appendChild(toast);
	        setTimeout(() => toast.classList.add('show'), 10);
	        setTimeout(() => {
	            toast.classList.remove('show');
	            setTimeout(() => toast.remove(), 300);
	        }, 2500);
	    }

	    // Tab-Funktionalität
	    const tabBtns = document.querySelectorAll('.tab-btn');
	    const tabPanels = document.querySelectorAll('.tab-panel');
	    tabBtns.forEach(btn => {
	        btn.addEventListener('click', () => {
	            const targetTab = btn.dataset.tab;
	            tabBtns.forEach(b => b.classList.remove('active'));
	            tabPanels.forEach(p => p.classList.remove('active'));
	            btn.classList.add('active');
	            document.getElementById(targetTab).classList.add('active');
	            localStorage.setItem('activeTab', targetTab);
	        });
	    });
	    // Aktiven Tab wiederherstellen
	    const savedTab = localStorage.getItem('activeTab') || 'general';
	    document.querySelector(`[data-tab="${savedTab}"]`).classList.add('active');
	    document.getElementById(savedTab).classList.add('active');

	    // Animationen
	    const animationsToggle = document.getElementById('animations-toggle');
	    const animationsStatus = document.getElementById('animations-status');
	    function updateAnimationsStatus() {
	        const enabled = animationsToggle.checked;
	        animationsStatus.textContent = enabled ? 'Animationen sind an' : 'Animationen sind aus';
	        localStorage.setItem('animationsEnabled', enabled ? 'true' : 'false');
	        document.body.classList.toggle('no-animations', !enabled);
	    }
	    animationsToggle.checked = localStorage.getItem('animationsEnabled') !== 'false';
	    updateAnimationsStatus();
	    animationsToggle.addEventListener('change', updateAnimationsStatus);

	    // High Contrast
	    const contrastToggle = document.getElementById('contrast-toggle');
	    const contrastStatus = document.getElementById('contrast-status');
	    function updateContrastStatus() {
	        const enabled = contrastToggle.checked;
	        contrastStatus.textContent = enabled ? 'High Contrast ist an' : 'High Contrast ist aus';
	        localStorage.setItem('highContrast', enabled ? 'true' : 'false');
	        document.body.classList.toggle('high-contrast', enabled);
	    }
	    contrastToggle.checked = localStorage.getItem('highContrast') === 'true';
	    updateContrastStatus();
	    contrastToggle.addEventListener('change', updateContrastStatus);

	    // Reduzierte Bewegungen
	    const reducedMotionToggle = document.getElementById('reduced-motion-toggle');
	    const reducedMotionStatus = document.getElementById('reduced-motion-status');
	    function updateReducedMotionStatus() {
	        const enabled = reducedMotionToggle.checked;
	        reducedMotionStatus.textContent = enabled ? 'Bewegungen sind reduziert' : 'Bewegungen sind normal';
	        localStorage.setItem('reducedMotion', enabled ? 'true' : 'false');
	        document.body.classList.toggle('reduced-motion', enabled);
	    }
	    reducedMotionToggle.checked = localStorage.getItem('reducedMotion') === 'true';
	    updateReducedMotionStatus();
	    reducedMotionToggle.addEventListener('change', updateReducedMotionStatus);

	    // Screen Reader
	    const screenReaderToggle = document.getElementById('screen-reader-toggle');
	    const screenReaderStatus = document.getElementById('screen-reader-status');
	    function updateScreenReaderStatus() {
	        const enabled = screenReaderToggle.checked;
	        screenReaderStatus.textContent = enabled ? 'Screen Reader ist an' : 'Screen Reader ist aus';
	        localStorage.setItem('screenReader', enabled ? 'true' : 'false');
	        document.body.classList.toggle('screen-reader-active', enabled);
	    }
	    screenReaderToggle.checked = localStorage.getItem('screenReader') === 'true';
	    updateScreenReaderStatus();
	    screenReaderToggle.addEventListener('change', updateScreenReaderStatus);

	    // Spieloptionen
	    // Timer Enabled
	    const timerEnabledToggle = document.getElementById('timer-enabled-toggle');
	    const timerEnabledStatus = document.getElementById('timer-enabled-status');
	    const timerDurationContainer = document.getElementById('timer-duration-container');
	    const timerVisualContainer = document.getElementById('timer-visual-container');
	    function updateTimerEnabledStatus() {
	        const enabled = timerEnabledToggle.checked;
	        timerEnabledStatus.textContent = enabled ? 'Timer ist an' : 'Timer ist aus';
	        localStorage.setItem('timerEnabled', enabled ? 'true' : 'false');
	        timerDurationContainer.style.display = enabled ? 'block' : 'none';
	        timerVisualContainer.style.display = enabled ? 'block' : 'none';
	    }
	    timerEnabledToggle.checked = localStorage.getItem('timerEnabled') === 'true';
	    updateTimerEnabledStatus();
	    timerEnabledToggle.addEventListener('change', updateTimerEnabledStatus);

	    // Timer Duration
	    const timerDurationSelect = document.getElementById('timer-duration-select');
	    function applyTimerDuration(duration) {
	        localStorage.setItem('timerDuration', duration);
	    }
	    const savedTimerDuration = localStorage.getItem('timerDuration') || '30';
	    timerDurationSelect.value = savedTimerDuration;
	    timerDurationSelect.addEventListener('change', (e) => {
	        applyTimerDuration(e.target.value);
	    });

	    // Timer Visual
	    const timerVisualToggle = document.getElementById('timer-visual-toggle');
	    const timerVisualStatus = document.getElementById('timer-visual-status');
	    function updateTimerVisualStatus() {
	        const enabled = timerVisualToggle.checked;
	        timerVisualStatus.textContent = enabled ? 'Visueller Timer ist an' : 'Visueller Timer ist aus';
	        localStorage.setItem('timerVisual', enabled ? 'true' : 'false');
	    }
	    timerVisualToggle.checked = localStorage.getItem('timerVisual') !== 'false';
	    updateTimerVisualStatus();
	    timerVisualToggle.addEventListener('change', updateTimerVisualStatus);

	    // Capital Mode
	    const capitalModeSelect = document.getElementById('capital-mode-select');
	    function applyCapitalMode(mode) {
	        localStorage.setItem('capitalMode', mode);
	    }
	    const savedCapitalMode = localStorage.getItem('capitalMode') || 'all';
	    capitalModeSelect.value = savedCapitalMode;
	    capitalModeSelect.addEventListener('change', (e) => {
	        applyCapitalMode(e.target.value);
	    });

	    // Balance Display Mode
	    const balanceDisplaySelect = document.getElementById('balance-display-select');
	    function applyBalanceDisplayMode(mode) {
	        localStorage.setItem('balanceDisplayMode', mode);
	    }
	    const savedBalanceDisplayMode = localStorage.getItem('balanceDisplayMode') || 'widget';
	    balanceDisplaySelect.value = savedBalanceDisplayMode;
	    balanceDisplaySelect.addEventListener('change', (e) => {
	        applyBalanceDisplayMode(e.target.value);
	    });

	    // Theme Auto-Modus
	    function applyTheme(theme) {
	        document.body.classList.remove('light-mode', 'dark-mode');
	        if (theme === 'auto') {
	            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
	            document.body.classList.add(prefersDark ? 'dark-mode' : 'light-mode');
	        } else {
	            document.body.classList.add(theme + '-mode');
	        }
	        localStorage.setItem('theme', theme);
	    }
	});
	</script>
</body>
</html>
