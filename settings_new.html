
<!DOCTYPE html>
<html lang="de">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Einstellungen</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link rel="stylesheet" href="css/main.css?v=20260109">
	<link rel="stylesheet" href="css/settings_new.css">
</head>
<body>
	<!-- Navbar -->
	<nav class="navbar">
		<div class="navbar-content">
			<a href="index.html" class="navbar-brand">
				<i class="fas fa-map-location-dot"></i> AUT Quiz
			</a>
			<div class="navbar-menu">
				<button class="menu-toggle" id="menuToggle" aria-label="Menü" type="button">
					<i class="fas fa-bars"></i>
				</button>
				<div class="menu-dropdown" id="menuDropdown">
					<a href="points.html" class="menu-item">
						<i class="fas fa-coins"></i> <span>Punkte: <span id="menuPointsDisplay">0</span></span>
					</a>
					<a href="help.html" class="menu-item">
						<i class="fas fa-question-circle"></i> Hilfe
					</a>
					<a href="faq.html" class="menu-item">
						<i class="fas fa-circle-question"></i> FAQ
					</a>
					<a href="stats.html" class="menu-item">
						<i class="fas fa-chart-bar"></i> Statistik
					</a>
					<a href="settings_new.html" class="menu-item">
						<i class="fas fa-cog"></i> Einstellungen
					</a>
				</div>
			</div>
		</div>
	</nav>

	<main class="container">
		<h1 class="settings-title"><i class="fas fa-cog"></i> Einstellungen</h1>
		<div class="settings-tabs">
			<button class="tab-btn active" data-tab="general">Allgemein</button>
			<button class="tab-btn" data-tab="appearance">Erscheinung</button>
			<button class="tab-btn" data-tab="game">Spieloptionen</button>
			<button class="tab-btn" data-tab="accessibility">Barrierefreiheit</button>
			<button class="tab-btn" data-tab="developer">Entwickler</button>
			<button class="tab-btn danger-tab" data-tab="danger">⚠️ Gefahrenzone</button>
		</div>
		<div class="settings-content">
			<div class="tab-panel active" id="general">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-language"></i> Sprache</h2>
						<label for="language-select">Sprache wählen:</label>
						<select id="language-select">
							<option value="de">Deutsch</option>
							<option value="en">English</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-volume-up"></i> Sound</h2>
						<label class="switch">
							<input type="checkbox" id="sound-toggle">
							<span class="slider round"></span>
						</label>
						<span id="sound-status">Sound ist aus</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-bell"></i> Benachrichtigungen</h2>
						<label class="switch">
							<input type="checkbox" id="notifications-toggle">
							<span class="slider round"></span>
						</label>
						<span id="notifications-status">Benachrichtigungen sind aus</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-history"></i> Fortschritt</h2>
						<button id="reset-progress-btn" class="reset-btn"><i class="fas fa-eraser"></i> Fortschritt zurücksetzen</button>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-undo"></i> Zurücksetzen</h2>
						<button id="reset-btn" class="reset-btn"><i class="fas fa-trash-restore"></i> Alle Einstellungen zurücksetzen</button>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="appearance">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-palette"></i> Design</h2>
						<label for="theme-select">Farbschema:</label>
						<select id="theme-select">
							<option value="light">Hell</option>
							<option value="dark">Dunkel</option>
							<option value="auto">Automatisch</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-font"></i> Schriftgröße</h2>
						<label for="font-size-slider">Schriftgröße: <span id="font-size-value">100%</span></label>
						<input type="range" id="font-size-slider" min="80" max="150" step="5" value="100">
						<div class="slider-info">
							<span>80%</span>
							<span>100%</span>
							<span>150%</span>
						</div>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-magic"></i> Animationen</h2>
						<label class="switch">
							<input type="checkbox" id="animations-toggle">
							<span class="slider round"></span>
						</label>
						<span id="animations-status">Animationen sind an</span>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="game">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-clock"></i> Timer</h2>
						<label class="switch">
							<input type="checkbox" id="timer-enabled-toggle">
							<span class="slider round"></span>
						</label>
						<span id="timer-enabled-status">Timer ist aus</span>
						<div id="timer-duration-container" style="display: none; margin-top: 1rem;">
							<label for="timer-duration-select">Timer-Dauer (Sekunden):</label>
							<select id="timer-duration-select">
								<option value="15">15</option>
								<option value="30">30</option>
								<option value="45">45</option>
								<option value="60">60</option>
							</select>
						</div>
						<div id="timer-visual-container" style="display: none; margin-top: 1rem;">
							<label class="switch">
								<input type="checkbox" id="timer-visual-toggle">
								<span class="slider round"></span>
							</label>
							<span id="timer-visual-status">Visueller Timer ist an</span>
						</div>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-map-marker-alt"></i> Hauptstadt-Modus</h2>
						<label for="capital-mode-select">Standard-Modus:</label>
						<select id="capital-mode-select">
							<option value="all">Alle Hauptstädte</option>
							<option value="federal">Bundesländer-Hauptstädte</option>
							<option value="district">Bezirkshauptstädte</option>
						</select>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-coins"></i> Punkte-Anzeige</h2>
						<label for="balance-display-select">Anzeige-Modus:</label>
						<select id="balance-display-select">
							<option value="widget">Widget</option>
							<option value="header">Im Header</option>
						</select>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="accessibility">
				<div class="settings-card">
					<section class="settings-section">
						<h2><i class="fas fa-eye"></i> High Contrast</h2>
						<label class="switch">
							<input type="checkbox" id="contrast-toggle">
							<span class="slider round"></span>
						</label>
						<span id="contrast-status">High Contrast ist aus</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-mouse-pointer"></i> Reduzierte Bewegungen</h2>
						<label class="switch">
							<input type="checkbox" id="reduced-motion-toggle">
							<span class="slider round"></span>
						</label>
						<span id="reduced-motion-status">Bewegungen sind normal</span>
					</section>
					<section class="settings-section">
						<h2><i class="fas fa-volume-off"></i> Screen Reader</h2>
						<label class="switch">
							<input type="checkbox" id="screen-reader-toggle">
							<span class="slider round"></span>
						</label>
						<span id="screen-reader-status">Screen Reader ist aus</span>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="developer">
				<div class="settings-card dev-tools-card">
					<section class="settings-section">
						<h2><i class="fas fa-tools"></i> Entwickler-Tools</h2>
						
						<div class="dev-option">
							<label class="switch">
								<input type="checkbox" id="devDarkMode">
								<span class="slider round"></span>
							</label>
							<span>Dark Mode</span>
						</div>
						
						<div class="dev-option">
							<label for="devAccentColor">Accent Farbe:</label>
							<input type="color" id="devAccentColor" value="#ed2939">
						</div>
						
						<div class="dev-option">
							<label class="switch">
								<input type="checkbox" id="devBottomNavEnabled">
								<span class="slider round"></span>
							</label>
							<span>Bottom Navigation aktivieren</span>
						</div>
						
						<div class="dev-option">
							<label class="switch">
								<input type="checkbox" id="devBottomNavFixed">
								<span class="slider round"></span>
							</label>
							<span>Bottom Navigation fixieren</span>
						</div>
						
						<div class="dev-option">
							<label class="switch">
								<input type="checkbox" id="devTimerEnabled">
								<span class="slider round"></span>
							</label>
							<span>Timer aktivieren</span>
						</div>
						
						<div class="dev-option">
							<label class="switch">
								<input type="checkbox" id="devTypoTolerance">
								<span class="slider round"></span>
							</label>
							<span>Typo-Toleranz aktivieren</span>
						</div>
						
						<div class="dev-option">
							<label class="switch">
								<input type="checkbox" id="devPaidHints">
								<span class="slider round"></span>
							</label>
							<span>Bezahlte Hinweise aktivieren</span>
						</div>
						
						<div class="dev-actions">
							<button id="devHardReloadBtn" class="dev-btn">
								<i class="fas fa-broom"></i> Hard Reload & Cache leeren
							</button>
							<button id="devSaveSettings" class="dev-btn">
								<i class="fas fa-save"></i> Einstellungen speichern
							</button>
						</div>
						
						<div id="devSaveFeedback" class="save-feedback" style="display: none;">
							<i class="fas fa-check"></i> Einstellungen gespeichert!
						</div>
					</section>
				</div>
			</div>
			<div class="tab-panel" id="danger">
				<div class="settings-card danger-card">
					<section class="settings-section">
						<h2><i class="fas fa-exclamation-triangle"></i> ⚠️ Gefahrenzone</h2>
						<p class="danger-warning">
							<strong>Achtung!</strong> Die folgenden Aktionen sind irreversibel und können nicht rückgängig gemacht werden.
							Bitte seien Sie vorsichtig bei der Verwendung dieser Funktionen.
						</p>
						
						<div class="danger-actions">
							<div class="danger-item">
								<h3><i class="fas fa-undo"></i> Fortschritt zurücksetzen</h3>
								<p>Löscht alle Punkte, gefundenen Easter Eggs und Spielstatistiken.</p>
								<button id="reset-progress-btn" class="danger-btn">
									<i class="fas fa-trash"></i> Fortschritt zurücksetzen
								</button>
							</div>
							
							<div class="danger-item">
								<h3><i class="fas fa-cog"></i> Einstellungen zurücksetzen</h3>
								<p>Setzt alle Einstellungen auf Standardwerte zurück.</p>
								<button id="reset-btn" class="danger-btn">
									<i class="fas fa-undo"></i> Einstellungen zurücksetzen
								</button>
							</div>
							
							<div class="danger-item">
								<h3><i class="fas fa-broom"></i> Cache leeren & Hard Reload</h3>
								<p>Leert den Browser-Cache und lädt die Seite komplett neu.</p>
								<button id="devHardReloadBtn" class="danger-btn">
									<i class="fas fa-broom"></i> Cache leeren & neu laden
								</button>
							</div>
						</div>
					</section>
				</div>
			</div>
		</div>
	</main>

	<!-- Footer Container - wird durch footer.js geladen -->
	<div id="footer-container"></div>

	<script src="components/footer.js"></script>
	<script src="script.js"></script>
	<script>
	// Settings-Initialisierung in EINEM DOMContentLoaded-Block
	document.addEventListener('DOMContentLoaded', function() {

	    // Theme
	    const themeSelect = document.getElementById('theme-select');
	    function applyTheme(theme) {
	        document.body.classList.remove('light-mode', 'dark-mode');
	        if (theme === 'auto') {
	            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
	            document.body.classList.add(prefersDark ? 'dark-mode' : 'light-mode');
	        } else {
	            document.body.classList.add(theme + '-mode');
	        }
	        localStorage.setItem('theme', theme);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    const savedTheme = localStorage.getItem('theme') || 'light';
	    themeSelect.value = savedTheme;
	    applyTheme(savedTheme);
	    themeSelect.addEventListener('change', (e) => {
	        applyTheme(e.target.value);
	    });

	    // Sprache
	    const languageSelect = document.getElementById('language-select');
	    function applyLanguage(lang) {
	        localStorage.setItem('language', lang);
	        // Platzhalter für spätere Übersetzungsfunktion
	    }
	    const savedLang = localStorage.getItem('language') || 'de';
	    languageSelect.value = savedLang;
	    languageSelect.addEventListener('change', (e) => {
	        applyLanguage(e.target.value);
	    });

	    // Schriftgröße
	    const fontSizeSlider = document.getElementById('font-size-slider');
	    const fontSizeValue = document.getElementById('font-size-value');
	    function applyFontSize(scale) {
	        const scaleValue = scale / 100;
	        document.documentElement.style.setProperty('--font-scale', scaleValue);
	        localStorage.setItem('fontScale', scale);
	        fontSizeValue.textContent = scale + '%';
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    const savedFontScale = localStorage.getItem('fontScale') || '100';
	    fontSizeSlider.value = savedFontScale;
	    applyFontSize(savedFontScale);
	    fontSizeSlider.addEventListener('input', (e) => {
	        applyFontSize(e.target.value);
	    });

	    // Sound
	    const soundToggle = document.getElementById('sound-toggle');
	    const soundStatus = document.getElementById('sound-status');
	    function updateSoundStatus() {
	        const enabled = soundToggle.checked;
	        soundStatus.textContent = enabled ? 'Sound ist an' : 'Sound ist aus';
	        soundStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('soundEnabled', enabled ? 'true' : 'false');
	    }
	    soundToggle.checked = localStorage.getItem('soundEnabled') === 'true';
	    updateSoundStatus();
	    soundToggle.addEventListener('change', updateSoundStatus);

	    // Benachrichtigungen
	    const notificationsToggle = document.getElementById('notifications-toggle');
	    const notificationsStatus = document.getElementById('notifications-status');
	    function updateNotificationStatus() {
	        const enabled = notificationsToggle.checked;
	        notificationsStatus.textContent = enabled ? 'Benachrichtigungen sind an' : 'Benachrichtigungen sind aus';
	        notificationsStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('notificationsEnabled', enabled ? 'true' : 'false');
	    }
	    notificationsToggle.checked = localStorage.getItem('notificationsEnabled') === 'true';
	    updateNotificationStatus();
	    notificationsToggle.addEventListener('change', updateNotificationStatus);

	    // Entwickler-Tools
	    // Dark Mode Toggle
	    const darkModeToggle = document.getElementById('devDarkMode');
	    function updateDarkModeStatus() {
	        const enabled = darkModeToggle.checked;
	        localStorage.setItem('darkMode', enabled ? 'true' : 'false');
	        document.body.classList.toggle('dark-mode', enabled);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    darkModeToggle.checked = localStorage.getItem('darkMode') === 'true';
	    updateDarkModeStatus();
	    darkModeToggle.addEventListener('change', updateDarkModeStatus);

	    // Accent Color Picker
	    const accentColorPicker = document.getElementById('devAccentColor');
	    function applyAccentColor(color) {
	        document.documentElement.style.setProperty('--accent-color', color);
	        document.documentElement.style.setProperty('--primary-color', color);
	        localStorage.setItem('accentColor', color);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    const savedAccentColor = localStorage.getItem('accentColor') || '#ed2939';
	    accentColorPicker.value = savedAccentColor;
	    applyAccentColor(savedAccentColor);
	    accentColorPicker.addEventListener('input', (e) => {
	        applyAccentColor(e.target.value);
	    });

	    // Bottom Navigation Toggle
	    const bottomNavToggle = document.getElementById('devBottomNavEnabled');
	    function updateBottomNavStatus() {
	        const enabled = bottomNavToggle.checked;
	        localStorage.setItem('bottomNavEnabled', enabled ? 'true' : 'false');
	        document.body.classList.toggle('bottom-nav-enabled', enabled);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    bottomNavToggle.checked = localStorage.getItem('bottomNavEnabled') !== 'false';
	    updateBottomNavStatus();
	    bottomNavToggle.addEventListener('change', updateBottomNavStatus);

	    // Timer Toggle
	    const devTimerToggle = document.getElementById('devTimerEnabled');
	    function updateDevTimerStatus() {
	        const enabled = devTimerToggle.checked;
	        localStorage.setItem('devTimerEnabled', enabled ? 'true' : 'false');
	    }
	    devTimerToggle.checked = localStorage.getItem('devTimerEnabled') === 'true';
	    updateDevTimerStatus();
	    devTimerToggle.addEventListener('change', updateDevTimerStatus);

	    // Typo Tolerance Toggle
	    const typoToleranceToggle = document.getElementById('devTypoTolerance');
	    function updateTypoToleranceStatus() {
	        const enabled = typoToleranceToggle.checked;
	        localStorage.setItem('typoToleranceEnabled', enabled ? 'true' : 'false');
	    }
	    typoToleranceToggle.checked = localStorage.getItem('typoToleranceEnabled') === 'true';
	    updateTypoToleranceStatus();
	    typoToleranceToggle.addEventListener('change', updateTypoToleranceStatus);

	    // Paid Hints Toggle
	    const paidHintsToggle = document.getElementById('devPaidHints');
	    function updatePaidHintsStatus() {
	        const enabled = paidHintsToggle.checked;
	        localStorage.setItem('paidHintsEnabled', enabled ? 'true' : 'false');
	    }
	    paidHintsToggle.checked = localStorage.getItem('paidHintsEnabled') === 'true';
	    updatePaidHintsStatus();
	    paidHintsToggle.addEventListener('change', updatePaidHintsStatus);

	    // Save Developer Settings
	    const saveDevSettingsBtn = document.getElementById('devSaveSettings');
	    const saveFeedback = document.getElementById('devSaveFeedback');
	    saveDevSettingsBtn.addEventListener('click', () => {
	        // Alle Entwickler-Einstellungen sind bereits in localStorage gespeichert
	        // Zeige Feedback an
	        saveFeedback.style.display = 'block';
	        setTimeout(() => {
	            saveFeedback.style.display = 'none';
	        }, 2000);
	    });

	    // Tab-Funktionalität
	    const tabBtns = document.querySelectorAll('.tab-btn');
	    const tabPanels = document.querySelectorAll('.tab-panel');
	    tabBtns.forEach(btn => {
	        btn.addEventListener('click', () => {
	            const targetTab = btn.dataset.tab;
	            tabBtns.forEach(b => b.classList.remove('active'));
	            tabPanels.forEach(p => p.classList.remove('active'));
	            btn.classList.add('active');
	            document.getElementById(targetTab).classList.add('active');
	            localStorage.setItem('activeTab', targetTab);
	        });
	    });
	    // Aktiven Tab wiederherstellen
	    const savedTab = localStorage.getItem('activeTab') || 'general';
	    document.querySelector(`[data-tab="${savedTab}"]`).classList.add('active');
	    document.getElementById(savedTab).classList.add('active');

	    // Animationen
	    const animationsToggle = document.getElementById('animations-toggle');
	    const animationsStatus = document.getElementById('animations-status');
	    function updateAnimationsStatus() {
	        const enabled = animationsToggle.checked;
	        animationsStatus.textContent = enabled ? 'Animationen sind an' : 'Animationen sind aus';
	        animationsStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('animationsEnabled', enabled ? 'true' : 'false');
	        document.body.classList.toggle('no-animations', !enabled);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    animationsToggle.checked = localStorage.getItem('animationsEnabled') !== 'false';
	    updateAnimationsStatus();
	    animationsToggle.addEventListener('change', updateAnimationsStatus);

	    // High Contrast
	    const contrastToggle = document.getElementById('contrast-toggle');
	    const contrastStatus = document.getElementById('contrast-status');
	    function updateContrastStatus() {
	        const enabled = contrastToggle.checked;
	        contrastStatus.textContent = enabled ? 'High Contrast ist an' : 'High Contrast ist aus';
	        contrastStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('highContrast', enabled ? 'true' : 'false');
	        document.body.classList.toggle('high-contrast', enabled);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    contrastToggle.checked = localStorage.getItem('highContrast') === 'true';
	    updateContrastStatus();
	    contrastToggle.addEventListener('change', updateContrastStatus);

	    // Reduzierte Bewegungen
	    const reducedMotionToggle = document.getElementById('reduced-motion-toggle');
	    const reducedMotionStatus = document.getElementById('reduced-motion-status');
	    function updateReducedMotionStatus() {
	        const enabled = reducedMotionToggle.checked;
	        reducedMotionStatus.textContent = enabled ? 'Bewegungen sind reduziert' : 'Bewegungen sind normal';
	        reducedMotionStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('reducedMotion', enabled ? 'true' : 'false');
	        document.body.classList.toggle('reduced-motion', enabled);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    reducedMotionToggle.checked = localStorage.getItem('reducedMotion') === 'true';
	    updateReducedMotionStatus();
	    reducedMotionToggle.addEventListener('change', updateReducedMotionStatus);

	    // Screen Reader
	    const screenReaderToggle = document.getElementById('screen-reader-toggle');
	    const screenReaderStatus = document.getElementById('screen-reader-status');
	    function updateScreenReaderStatus() {
	        const enabled = screenReaderToggle.checked;
	        screenReaderStatus.textContent = enabled ? 'Screen Reader ist an' : 'Screen Reader ist aus';
	        screenReaderStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('screenReader', enabled ? 'true' : 'false');
	        document.body.classList.toggle('screen-reader-active', enabled);
	        if (window.applyGlobalSettings) window.applyGlobalSettings();
	    }
	    screenReaderToggle.checked = localStorage.getItem('screenReader') === 'true';
	    updateScreenReaderStatus();
	    screenReaderToggle.addEventListener('change', updateScreenReaderStatus);

	    // Spieloptionen
	    // Timer Enabled
	    const timerEnabledToggle = document.getElementById('timer-enabled-toggle');
	    const timerEnabledStatus = document.getElementById('timer-enabled-status');
	    const timerDurationContainer = document.getElementById('timer-duration-container');
	    const timerVisualContainer = document.getElementById('timer-visual-container');
	    function updateTimerEnabledStatus() {
	        const enabled = timerEnabledToggle.checked;
	        timerEnabledStatus.textContent = enabled ? 'Timer ist an' : 'Timer ist aus';
	        timerEnabledStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('timerEnabled', enabled ? 'true' : 'false');
	        timerDurationContainer.style.display = enabled ? 'block' : 'none';
	        timerVisualContainer.style.display = enabled ? 'block' : 'none';
	    }
	    timerEnabledToggle.checked = localStorage.getItem('timerEnabled') === 'true';
	    updateTimerEnabledStatus();
	    timerEnabledToggle.addEventListener('change', updateTimerEnabledStatus);

	    // Timer Duration
	    const timerDurationSelect = document.getElementById('timer-duration-select');
	    function applyTimerDuration(duration) {
	        localStorage.setItem('timerDuration', duration);
	    }
	    const savedTimerDuration = localStorage.getItem('timerDuration') || '30';
	    timerDurationSelect.value = savedTimerDuration;
	    timerDurationSelect.addEventListener('change', (e) => {
	        applyTimerDuration(e.target.value);
	    });

	    // Timer Visual
	    const timerVisualToggle = document.getElementById('timer-visual-toggle');
	    const timerVisualStatus = document.getElementById('timer-visual-status');
	    function updateTimerVisualStatus() {
	        const enabled = timerVisualToggle.checked;
	        timerVisualStatus.textContent = enabled ? 'Visueller Timer ist an' : 'Visueller Timer ist aus';
	        timerVisualStatus.classList.toggle('enabled', enabled);
	        localStorage.setItem('timerVisual', enabled ? 'true' : 'false');
	    }
	    timerVisualToggle.checked = localStorage.getItem('timerVisual') !== 'false';
	    updateTimerVisualStatus();
	    timerVisualToggle.addEventListener('change', updateTimerVisualStatus);

	    // Capital Mode
	    const capitalModeSelect = document.getElementById('capital-mode-select');
	    function applyCapitalMode(mode) {
	        localStorage.setItem('capitalMode', mode);
	    }
	    const savedCapitalMode = localStorage.getItem('capitalMode') || 'all';
	    capitalModeSelect.value = savedCapitalMode;
	    capitalModeSelect.addEventListener('change', (e) => {
	        applyCapitalMode(e.target.value);
	    });

	    // Balance Display Mode
	    const balanceDisplaySelect = document.getElementById('balance-display-select');
	    function applyBalanceDisplayMode(mode) {
	        localStorage.setItem('balanceDisplayMode', mode);
	    }
	    const savedBalanceDisplayMode = localStorage.getItem('balanceDisplayMode') || 'widget';
	    balanceDisplaySelect.value = savedBalanceDisplayMode;
	    balanceDisplaySelect.addEventListener('change', (e) => {
	        applyBalanceDisplayMode(e.target.value);
	    });

	    // ============================================
	    // GEFahrenzone - Gefährliche Funktionen
	    // ============================================

	    // Fortschritt zurücksetzen
	    const resetProgressBtn = document.getElementById('reset-progress-btn');
	    if (resetProgressBtn) {
	        function resetProgress() {
	            if (confirm('⚠️ Sind Sie sicher, dass Sie Ihren gesamten Fortschritt zurücksetzen möchten?\n\nDies löscht:\n- Alle Punkte\n- Alle gefundenen Easter Eggs\n- Alle Spielstatistiken\n\nDiese Aktion kann nicht rückgängig gemacht werden!')) {
	                localStorage.removeItem('pointsData');
	                localStorage.removeItem('foundEasterEggs');
	                localStorage.removeItem('gameStats');
	                alert('✅ Fortschritt wurde erfolgreich zurückgesetzt!');
	                location.reload();
	            }
	        }
	        resetProgressBtn.addEventListener('click', resetProgress);
	    }

	    // Einstellungen zurücksetzen
	    const resetBtn = document.getElementById('reset-btn');
	    if (resetBtn) {
	        function resetSettings() {
	            if (confirm('⚠️ Sind Sie sicher, dass Sie alle Einstellungen zurücksetzen möchten?\n\nDies setzt alle Einstellungen auf Standardwerte zurück.\n\nDiese Aktion kann nicht rückgängig gemacht werden!')) {
	                localStorage.clear();
	                alert('✅ Einstellungen wurden erfolgreich zurückgesetzt!');
	                location.reload();
	            }
	        }
	        resetBtn.addEventListener('click', resetSettings);
	    }

	    // Hard Reload & Cache leeren
	    const devHardReloadBtn = document.getElementById('devHardReloadBtn');
	    if (devHardReloadBtn) {
	        devHardReloadBtn.addEventListener('click', async (e) => {
	            e.preventDefault();
	            if (confirm('⚠️ Sind Sie sicher, dass Sie den Cache leeren und die Seite neu laden möchten?\n\nDies kann bei technischen Problemen helfen.')) {
	                devHardReloadBtn.classList.add('spinning');
	                devHardReloadBtn.disabled = true;
	                try {
	                    // Service Worker Cache leeren
	                    if ('caches' in window) {
	                        const cacheNames = await caches.keys();
	                        await Promise.all(cacheNames.map(name => caches.delete(name)));
	                    }
	                    // Service Worker deregistrieren
	                    if ('serviceWorker' in navigator) {
	                        const registrations = await navigator.serviceWorker.getRegistrations();
	                        await Promise.all(registrations.map(reg => reg.unregister()));
	                    }
	                    sessionStorage.setItem('cacheCleared', 'true');
	                    setTimeout(() => { location.reload(true); }, 500);
	                } catch (error) {
	                    console.error('Cache clear error:', error);
	                    location.reload(true);
	                }
	            }
	        });
	        // Zeige Erfolgs-Toast wenn gerade Cache geleert wurde
	        if (sessionStorage.getItem('cacheCleared') === 'true') {
	            sessionStorage.removeItem('cacheCleared');
	            showCacheClearedToast();
	        }
	    }

	    // Toast-Notification für Cache Clear
	    function showCacheClearedToast() {
	        const toast = document.createElement('div');
	        toast.className = 'cache-cleared-toast';
	        toast.innerHTML = `<i class="fas fa-check-circle"></i> <span>Cache geleert & neu geladen!</span>`;
	        document.body.appendChild(toast);
	        setTimeout(() => toast.classList.add('show'), 10);
	        setTimeout(() => {
	            toast.classList.remove('show');
	            setTimeout(() => toast.remove(), 300);
	        }, 2500);
	    }

	    // Theme Auto-Modus
	    function applyTheme(theme) {
	        document.body.classList.remove('light-mode', 'dark-mode');
	        if (theme === 'auto') {
	            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
	            document.body.classList.add(prefersDark ? 'dark-mode' : 'light-mode');
	        } else {
	            document.body.classList.add(theme + '-mode');
	        }
	        localStorage.setItem('theme', theme);
	    }
	});
	</script>
</body>
</html>
