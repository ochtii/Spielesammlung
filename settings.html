<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUT Quiz - Einstellungen</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-content">
            <a href="index.html" class="navbar-brand">
                <i class="fas fa-map-location-dot"></i> AUT Quiz
            </a>
            <div class="navbar-menu">
                <button class="menu-toggle" id="menuToggle" aria-label="Men√º" type="button">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="menu-dropdown" id="menuDropdown">
                    <a href="index.html" class="menu-item">
                        <i class="fas fa-home"></i> Zur√ºck zum Spiel
                    </a>
                    <a href="points.html" class="menu-item">
                        <i class="fas fa-coins"></i> Punkte
                    </a>
                    <a href="help.html" class="menu-item">
                        <i class="fas fa-question-circle"></i> Hilfe
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="settings-page">
            <div class="settings-page-header">
                <i class="fas fa-cog settings-page-icon"></i>
                <h1>Einstellungen</h1>
            </div>

            <div class="settings-page-section">
                <h2><i class="fas fa-palette"></i> Darstellung</h2>
                <div class="settings-card">
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Dark Mode</span>
                            <span class="settings-option-desc">Dunkles Farbschema aktivieren</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeCheck">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="settings-page-section">
                <h2><i class="fas fa-bars"></i> Bottom Navigation</h2>
                <div class="settings-card">
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Bottom Navigation anzeigen</span>
                            <span class="settings-option-desc">Zeigt die Navigation am unteren Bildschirmrand (nur mobil)</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="bottomNavEnabledCheck">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Am Bildschirm fixiert</span>
                            <span class="settings-option-desc">Navigation bleibt beim Scrollen sichtbar</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="bottomNavFixedCheck">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Gr√∂√üe</span>
                            <span class="settings-option-desc">Gr√∂√üe der Navigation und Icons</span>
                        </div>
                        <select id="bottomNavSizeSelect" class="settings-select">
                            <option value="small">Klein</option>
                            <option value="normal">Normal</option>
                            <option value="large">Gro√ü</option>
                        </select>
                    </div>
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Angezeigte Schaltfl√§chen</span>
                            <span class="settings-option-desc">W√§hle welche Buttons angezeigt werden</span>
                        </div>
                    </div>
                    <div class="settings-option-checkboxes">
                        <label class="checkbox-label">
                            <input type="checkbox" id="bottomNavShowHome" checked>
                            <span><i class="fas fa-home"></i> Spiel</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="bottomNavShowPoints" checked>
                            <span><i class="fas fa-coins"></i> Punkte</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="bottomNavShowHelp" checked>
                            <span><i class="fas fa-question-circle"></i> Hilfe</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="bottomNavShowFaq">
                            <span><i class="fas fa-comment-dots"></i> FAQ</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="bottomNavShowSettings" checked>
                            <span><i class="fas fa-cog"></i> Einstellungen</span>
                        </label>
                    </div>
                </div>
                <div class="settings-save-section">
                    <button class="btn btn-primary" id="saveBottomNavBtn">
                        <i class="fas fa-save"></i> Bottom Navigation Einstellungen speichern
                    </button>
                    <div class="save-feedback" id="bottomNavSaveFeedback" style="display: none;">
                        <i class="fas fa-check-circle"></i>
                        <span>Einstellungen erfolgreich gespeichert!</span>
                    </div>
                </div>
            </div>

            <div class="settings-page-section">
                <h2><i class="fas fa-gamepad"></i> Spieloptionen</h2>
                <div class="settings-card">
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Tippfehler akzeptieren</span>
                            <span class="settings-option-desc">Erlaubt kleine Abweichungen bei Antworten</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="typoToleranceCheck">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Kostenpflichtige Tipps</span>
                            <span class="settings-option-desc">Tipps kosten gesammelte Punkte</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="paidHintsCheck">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Guthaben-Anzeige</span>
                            <span class="settings-option-desc">Wo das Guthaben angezeigt wird (wenn kostenpflichtig)</span>
                        </div>
                        <select id="balanceDisplaySelect" class="settings-select">
                            <option value="widget">Floating Widget</option>
                            <option value="header">Im Header</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="settings-page-section">
                <h2><i class="fas fa-database"></i> Datenspeicherung</h2>
                <div class="settings-card">
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Historie-Gr√∂√üe</span>
                            <span class="settings-option-desc">Maximale Anzahl gespeicherter Eintr√§ge</span>
                        </div>
                        <select id="historyLimitSelect" class="settings-select">
                            <option value="20">20 Eintr√§ge (Minimal)</option>
                            <option value="50">50 Eintr√§ge (Klein)</option>
                            <option value="100">100 Eintr√§ge (Standard)</option>
                            <option value="200">200 Eintr√§ge (Gro√ü)</option>
                            <option value="500">500 Eintr√§ge (Maximal)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="settings-page-section dev-tools-section">
                <h2><i class="fas fa-code"></i> Entwickler Tools</h2>
                <div class="settings-card dev-tools-card">
                    <div class="settings-option">
                        <div class="settings-option-info">
                            <span class="settings-option-label">Entwickler Tools aktivieren</span>
                            <span class="settings-option-desc">Zeigt erweiterte Informationen und Debug-Optionen</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="devModeCheck">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div id="devModeOptions" class="dev-mode-options">
                        <div class="dev-tools-header">
                            <i class="fas fa-tools"></i>
                            <h3>Debug & Verwaltung</h3>
                            <p>Erweiterte Tools f√ºr Entwickler und fortgeschrittene Benutzer</p>
                        </div>
                        
                        <div class="dev-tools-grid">
                            <button class="dev-tool-btn dev-tool-info" id="showLocalStorageBtn">
                                <div class="dev-tool-icon">
                                    <i class="fas fa-database"></i>
                                </div>
                                <div class="dev-tool-content">
                                    <h4>LocalStorage</h4>
                                    <p>Gespeicherte Daten anzeigen</p>
                                </div>
                            </button>
                            
                            <button class="dev-tool-btn dev-tool-warning" id="resetAllSettingsBtn">
                                <div class="dev-tool-icon">
                                    <i class="fas fa-undo"></i>
                                </div>
                                <div class="dev-tool-content">
                                    <h4>Einstellungen</h4>
                                    <p>Alle zur√ºcksetzen</p>
                                </div>
                            </button>
                            
                            <button class="dev-tool-btn dev-tool-danger" id="resetPointsBtn">
                                <div class="dev-tool-icon">
                                    <i class="fas fa-eraser"></i>
                                </div>
                                <div class="dev-tool-content">
                                    <h4>Punkte</h4>
                                    <p>Statistiken l√∂schen</p>
                                </div>
                            </button>
                            
                            <button class="dev-tool-btn dev-tool-success" id="exportDataBtn">
                                <div class="dev-tool-icon">
                                    <i class="fas fa-download"></i>
                                </div>
                                <div class="dev-tool-content">
                                    <h4>Export</h4>
                                    <p>Daten sichern</p>
                                </div>
                            </button>
                            
                            <button class="dev-tool-btn dev-tool-warning" id="clearHistoryBtn">
                                <div class="dev-tool-icon">
                                    <i class="fas fa-trash"></i>
                                </div>
                                <div class="dev-tool-content">
                                    <h4>Historie</h4>
                                    <p>Verlauf l√∂schen</p>
                                </div>
                            </button>
                            
                            <button class="dev-tool-btn dev-tool-info" id="toggleFooterInfoBtn">
                                <div class="dev-tool-icon">
                                    <i class="fas fa-info-circle"></i>
                                </div>
                                <div class="dev-tool-content">
                                    <h4>Footer</h4>
                                    <p>Info erweitern</p>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-page-actions">
                <a href="index.html" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Zur√ºck
                </a>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav" id="bottomNav">
        <div class="bottom-nav-content">
            <a href="index.html" class="bottom-nav-item" data-nav="home">
                <i class="fas fa-home"></i>
                <span>Spiel</span>
            </a>
            <a href="points.html" class="bottom-nav-item" data-nav="points">
                <i class="fas fa-coins"></i>
                <span>Punkte</span>
            </a>
            <a href="help.html" class="bottom-nav-item" data-nav="help">
                <i class="fas fa-question-circle"></i>
                <span>Hilfe</span>
            </a>
            <a href="settings.html" class="bottom-nav-item current" data-nav="settings">
                <i class="fas fa-cog"></i>
                <span>Einstellungen</span>
            </a>
        </div>
    </nav>

    <footer class="footer">
        <div class="footer-content">
            <button class="footer-zoom-btn" id="zoomResetBtn">
                <i class="fas fa-search-minus"></i>
                <span>Ansicht auf 100% zur√ºcksetzen</span>
            </button>
            <p id="commitInfo">Version wird geladen...</p>
        </div>
    </footer>

    <script>
        // Theme laden
        function loadTheme() {
            const theme = localStorage.getItem('theme') || 'light';
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
            }
        }

        // Einstellungen laden
        function loadSettings() {
            const theme = localStorage.getItem('theme') || 'light';
            const typoTolerance = localStorage.getItem('typoTolerance') !== 'false';
            const paidHints = localStorage.getItem('paidHints') === 'true';
            const balanceDisplayMode = localStorage.getItem('balanceDisplayMode') || 'widget';
            const historyLimit = localStorage.getItem('historyLimit') || '100';
            const devMode = localStorage.getItem('devMode') === 'true';
            
            // Bottom Nav Einstellungen
            const bottomNavEnabled = localStorage.getItem('bottomNavEnabled') !== 'false';
            const bottomNavFixed = localStorage.getItem('bottomNavFixed') !== 'false';
            const bottomNavSize = localStorage.getItem('bottomNavSize') || 'normal';
            const bottomNavShowHome = localStorage.getItem('bottomNavShowHome') !== 'false';
            const bottomNavShowPoints = localStorage.getItem('bottomNavShowPoints') !== 'false';
            const bottomNavShowHelp = localStorage.getItem('bottomNavShowHelp') !== 'false';
            const bottomNavShowFaq = localStorage.getItem('bottomNavShowFaq') === 'true';
            const bottomNavShowSettings = localStorage.getItem('bottomNavShowSettings') !== 'false';

            document.getElementById('darkModeCheck').checked = theme === 'dark';
            document.getElementById('typoToleranceCheck').checked = typoTolerance;
            document.getElementById('paidHintsCheck').checked = paidHints;
            document.getElementById('balanceDisplaySelect').value = balanceDisplayMode;
            document.getElementById('historyLimitSelect').value = historyLimit;
            document.getElementById('devModeCheck').checked = devMode;
            
            // Dev Mode Options anzeigen/verstecken
            toggleDevModeOptions(devMode);
            
            // Bottom Nav
            document.getElementById('bottomNavEnabledCheck').checked = bottomNavEnabled;
            document.getElementById('bottomNavFixedCheck').checked = bottomNavFixed;
            document.getElementById('bottomNavSizeSelect').value = bottomNavSize;
            document.getElementById('bottomNavShowHome').checked = bottomNavShowHome;
            document.getElementById('bottomNavShowPoints').checked = bottomNavShowPoints;
            document.getElementById('bottomNavShowHelp').checked = bottomNavShowHelp;
            document.getElementById('bottomNavShowFaq').checked = bottomNavShowFaq;
            document.getElementById('bottomNavShowSettings').checked = bottomNavShowSettings;
            
            // Bottom Nav anwenden
            applyBottomNavSettings();
        }
        
        // Bottom Nav Einstellungen anwenden
        function applyBottomNavSettings() {
            const bottomNav = document.getElementById('bottomNav');
            if (!bottomNav) return;
            
            const enabled = localStorage.getItem('bottomNavEnabled') !== 'false';
            const fixed = localStorage.getItem('bottomNavFixed') !== 'false';
            const size = localStorage.getItem('bottomNavSize') || 'normal';
            const showHome = localStorage.getItem('bottomNavShowHome') !== 'false';
            const showPoints = localStorage.getItem('bottomNavShowPoints') !== 'false';
            const showHelp = localStorage.getItem('bottomNavShowHelp') !== 'false';
            const showFaq = localStorage.getItem('bottomNavShowFaq') === 'true';
            const showSettings = localStorage.getItem('bottomNavShowSettings') !== 'false';
            
            // Enabled/Disabled
            if (enabled) {
                bottomNav.style.display = '';
            } else {
                bottomNav.style.display = 'none';
            }
            
            // Fixed/Static - wichtig: Klasse entfernen und neu setzen
            bottomNav.classList.remove('position-static');
            if (!fixed) {
                bottomNav.classList.add('position-static');
            }
            
            // Gr√∂√üe
            bottomNav.classList.remove('size-small', 'size-normal', 'size-large');
            bottomNav.classList.add('size-' + size);
            
            // Items anzeigen/ausblenden
            const items = bottomNav.querySelectorAll('.bottom-nav-item');
            items.forEach(item => {
                const nav = item.getAttribute('data-nav');
                item.classList.remove('hidden');
                
                if (nav === 'home' && !showHome) item.classList.add('hidden');
                if (nav === 'points' && !showPoints) item.classList.add('hidden');
                if (nav === 'help' && !showHelp) item.classList.add('hidden');
                if (nav === 'faq' && !showFaq) item.classList.add('hidden');
                if (nav === 'settings' && !showSettings) item.classList.add('hidden');
            });
        }

        // Bottom Nav Einstellungen speichern
        function saveBottomNavSettings() {
            // Alle Einstellungen speichern
            const enabled = document.getElementById('bottomNavEnabledCheck').checked;
            const fixed = document.getElementById('bottomNavFixedCheck').checked;
            const size = document.getElementById('bottomNavSizeSelect').value;
            const showHome = document.getElementById('bottomNavShowHome').checked;
            const showPoints = document.getElementById('bottomNavShowPoints').checked;
            const showHelp = document.getElementById('bottomNavShowHelp').checked;
            const showFaq = document.getElementById('bottomNavShowFaq').checked;
            const showSettings = document.getElementById('bottomNavShowSettings').checked;
            
            localStorage.setItem('bottomNavEnabled', enabled);
            localStorage.setItem('bottomNavFixed', fixed);
            localStorage.setItem('bottomNavSize', size);
            localStorage.setItem('bottomNavShowHome', showHome);
            localStorage.setItem('bottomNavShowPoints', showPoints);
            localStorage.setItem('bottomNavShowHelp', showHelp);
            localStorage.setItem('bottomNavShowFaq', showFaq);
            localStorage.setItem('bottomNavShowSettings', showSettings);
            
            // Einstellungen anwenden
            applyBottomNavSettings();
            
            // Feedback anzeigen
            const feedback = document.getElementById('bottomNavSaveFeedback');
            feedback.style.display = 'flex';
            setTimeout(() => {
                feedback.style.display = 'none';
            }, 3000);
        }

        // Auto-Save bei √Ñnderungen
        function setupAutoSave() {
            // Dark Mode
            document.getElementById('darkModeCheck').addEventListener('change', (e) => {
                if (e.target.checked) {
                    document.body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light');
                }
            });

            // Tippfehler-Toleranz
            document.getElementById('typoToleranceCheck').addEventListener('change', (e) => {
                localStorage.setItem('typoTolerance', e.target.checked);
            });

            // Kostenpflichtige Tipps
            document.getElementById('paidHintsCheck').addEventListener('change', (e) => {
                localStorage.setItem('paidHints', e.target.checked);
            });

            // Bottom Navigation Speichern Button
            document.getElementById('saveBottomNavBtn').addEventListener('click', saveBottomNavSettings);


            // Balance Display
            document.getElementById('balanceDisplaySelect').addEventListener('change', (e) => {
                localStorage.setItem('balanceDisplayMode', e.target.value);
            });

            // Historie Limit
            document.getElementById('historyLimitSelect').addEventListener('change', (e) => {
                localStorage.setItem('historyLimit', e.target.value);
            });
            
            // Entwicklermodus
            document.getElementById('devModeCheck').addEventListener('change', (e) => {
                const isEnabled = e.target.checked;
                localStorage.setItem('devMode', isEnabled);
                toggleDevModeOptions(isEnabled);
            });
            
            // Bottom Nav Einstellungen
            document.getElementById('bottomNavEnabledCheck').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavEnabled', e.target.checked);
                applyBottomNavSettings();
            });
            
            document.getElementById('bottomNavFixedCheck').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavFixed', e.target.checked);
                applyBottomNavSettings();
            });
            
            document.getElementById('bottomNavSizeSelect').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavSize', e.target.value);
                applyBottomNavSettings();
            });
            
            document.getElementById('bottomNavShowHome').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavShowHome', e.target.checked);
                applyBottomNavSettings();
            });
            
            document.getElementById('bottomNavShowPoints').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavShowPoints', e.target.checked);
                applyBottomNavSettings();
            });
            
            document.getElementById('bottomNavShowHelp').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavShowHelp', e.target.checked);
                applyBottomNavSettings();
            });
            
            document.getElementById('bottomNavShowSettings').addEventListener('change', (e) => {
                localStorage.setItem('bottomNavShowSettings', e.target.checked);
                applyBottomNavSettings();
            });
        }

        // Menu Setup
        function setupMenu() {
            const menuToggle = document.getElementById('menuToggle');
            const menuDropdown = document.getElementById('menuDropdown');
            
            if (menuToggle && menuDropdown) {
                menuToggle.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    menuToggle.classList.toggle('active');
                    menuDropdown.classList.toggle('show');
                });
                
                document.addEventListener('click', (e) => {
                    if (!menuToggle.contains(e.target) && !menuDropdown.contains(e.target)) {
                        menuToggle.classList.remove('active');
                        menuDropdown.classList.remove('show');
                    }
                });
            }
        }

        // Entwicklermodus Funktionen
        function toggleDevModeOptions(show) {
            const devOptions = document.getElementById('devModeOptions');
            if (devOptions) {
                devOptions.style.display = show ? 'block' : 'none';
            }
        }

        function setupDevTools() {
            // LocalStorage anzeigen
            document.getElementById('showLocalStorageBtn')?.addEventListener('click', () => {
                const data = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    data.push({ key, value });
                }
                
                let message = 'üì¶ LocalStorage Inhalt:\n\n';
                data.forEach(item => {
                    message += `${item.key}: ${item.value}\n`;
                });
                
                alert(message);
            });

            // Alle Einstellungen zur√ºcksetzen
            document.getElementById('resetAllSettingsBtn')?.addEventListener('click', () => {
                if (confirm('‚ö†Ô∏è M√∂chtest du wirklich ALLE Einstellungen zur√ºcksetzen?\n\nDies setzt zur√ºck:\n- Theme\n- Spieloptionen\n- Bottom Navigation\n- Historie-Gr√∂√üe\n- Entwicklermodus\n\nPunkte und Statistiken bleiben erhalten!')) {
                    const keysToKeep = ['totalPoints', 'totalGamesPlayed', 'gamesWon', 'gamesLost', 'gamesHistory'];
                    const savedData = {};
                    
                    keysToKeep.forEach(key => {
                        const value = localStorage.getItem(key);
                        if (value) savedData[key] = value;
                    });
                    
                    localStorage.clear();
                    
                    Object.keys(savedData).forEach(key => {
                        localStorage.setItem(key, savedData[key]);
                    });
                    
                    alert('‚úÖ Einstellungen wurden zur√ºckgesetzt!\n\nDie Seite wird neu geladen...');
                    window.location.reload();
                }
            });

            // Punkte zur√ºcksetzen
            document.getElementById('resetPointsBtn')?.addEventListener('click', () => {
                if (confirm('‚ö†Ô∏è M√∂chtest du wirklich alle Punkte und Statistiken zur√ºcksetzen?\n\nDies kann nicht r√ºckg√§ngig gemacht werden!')) {
                    localStorage.removeItem('totalPoints');
                    localStorage.removeItem('totalGamesPlayed');
                    localStorage.removeItem('gamesWon');
                    localStorage.removeItem('gamesLost');
                    
                    alert('‚úÖ Punkte und Statistiken wurden zur√ºckgesetzt!');
                }
            });

            // Daten exportieren
            document.getElementById('exportDataBtn')?.addEventListener('click', () => {
                const data = {};
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    data[key] = localStorage.getItem(key);
                }
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `spielesammlung_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('‚úÖ Daten wurden als JSON-Datei heruntergeladen!');
            });

            // Historie l√∂schen
            document.getElementById('clearHistoryBtn')?.addEventListener('click', () => {
                if (confirm('‚ö†Ô∏è M√∂chtest du die komplette Spiel-Historie l√∂schen?\n\nPunkte und Statistiken bleiben erhalten!')) {
                    localStorage.removeItem('gamesHistory');
                    alert('‚úÖ Historie wurde gel√∂scht!');
                }
            });

            // Footer-Info erweitern
            document.getElementById('toggleFooterInfoBtn')?.addEventListener('click', () => {
                const footer = document.getElementById('commitInfo');
                if (!footer) return;
                
                if (footer.dataset.expanded === 'true') {
                    loadCommitTime();
                    footer.dataset.expanded = 'false';
                    document.getElementById('toggleFooterInfoBtn').innerHTML = '<i class="fas fa-info-circle"></i><span>Footer-Info erweitern</span>';
                } else {
                    const allData = [];
                    allData.push(`üéÆ Gesamtpunkte: ${localStorage.getItem('totalPoints') || 0}`);
                    allData.push(`üìä Gespielte Spiele: ${localStorage.getItem('totalGamesPlayed') || 0}`);
                    allData.push(`‚úÖ Gewonnen: ${localStorage.getItem('gamesWon') || 0}`);
                    allData.push(`‚ùå Verloren: ${localStorage.getItem('gamesLost') || 0}`);
                    allData.push(`üíæ LocalStorage Gr√∂√üe: ${new Blob(Object.values(localStorage)).size} bytes`);
                    allData.push(`üîß Dev-Mode: ${localStorage.getItem('devMode') === 'true' ? 'An' : 'Aus'}`);
                    
                    footer.innerHTML = allData.join(' <span class="footer-separator">|</span> ');
                    footer.dataset.expanded = 'true';
                    document.getElementById('toggleFooterInfoBtn').innerHTML = '<i class="fas fa-compress"></i><span>Footer-Info minimieren</span>';
                }
            });
        }

        // Load Commit Info
        async function loadCommitTime() {
            const commitInfoEl = document.getElementById('commitInfo');
            
            try {
                const controller = new AbortController();
                const timeout = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch(
                    'https://api.github.com/repos/ochtii/Spielesammlung/commits?per_page=1',
                    { signal: controller.signal }
                );
                clearTimeout(timeout);
                
                if (!response.ok) throw new Error('API Error');
                
                const data = await response.json();
                if (data.length > 0) {
                    const commit = data[0];
                    const commitDate = new Date(commit.commit.author.date);
                    const options = {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        timeZone: 'Europe/Vienna'
                    };
                    const formattedDate = new Intl.DateTimeFormat('de-AT', options).format(commitDate);
                    
                    const commitDetailResponse = await fetch(
                        `https://api.github.com/repos/ochtii/Spielesammlung/commits/${commit.sha}`,
                        { signal: controller.signal }
                    );
                    
                    let filesChanged = '';
                    if (commitDetailResponse.ok) {
                        const commitDetail = await commitDetailResponse.json();
                        if (commitDetail.files && commitDetail.files.length > 0) {
                            const fileNames = commitDetail.files.map(f => f.filename).slice(0, 3);
                            filesChanged = fileNames.join(', ');
                            if (commitDetail.files.length > 3) {
                                filesChanged += ` (+${commitDetail.files.length - 3})`;
                            }
                        }
                    }
                    
                    let infoText = `<i class="fas fa-clock"></i> ${formattedDate}`;
                    if (filesChanged) {
                        infoText += ` <span class="footer-separator">|</span> <i class="fas fa-file-code"></i> ${filesChanged}`;
                    }
                    
                    commitInfoEl.innerHTML = infoText;
                    return;
                }
            } catch (error) {
                commitInfoEl.innerHTML = '<i class="fas fa-wifi"></i> Offline';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadTheme();
            loadSettings();
            setupAutoSave();
            setupMenu();
            setupDevTools();
            loadCommitTime();
            
            // Zoom Reset
            const zoomBtn = document.getElementById('zoomResetBtn');
            if (zoomBtn) {
                zoomBtn.addEventListener('click', () => {
                    const viewport = document.querySelector('meta[name="viewport"]');
                    if (viewport) {
                        viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
                        setTimeout(() => {
                            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0');
                        }, 100);
                    }
                    zoomBtn.innerHTML = '<i class="fas fa-check"></i><span>Zur√ºckgesetzt!</span>';
                    setTimeout(() => {
                        zoomBtn.innerHTML = '<i class="fas fa-search-minus"></i><span>Ansicht auf 100% zur√ºcksetzen</span>';
                    }, 2000);
                });
            }
        });
    </script>
</body>
</html>
